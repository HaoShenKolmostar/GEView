<html>
<head>
<title>Google Map</title>

<script src="http://maps.google.com/maps/api/js?v=3.22" type="text/javascript" charset="UTF-8"></script>
<script type="text/javascript">

var map = null;
var mark;
var icon = "http://maps.google.co.jp/mapfiles/ms/icons/red-dot.png";

function init() {
    var opt = {
        center: new google.maps.LatLng(0, 0),
        zoom: 15, minZoom: 2,
        streetViewControl: false,
        scrollwheel: true,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map"), opt);
        
    window.external.setLatLon();
}

function SetCent(lat, lon) {
    if (map == null) return;
    map.setCenter(new google.maps.LatLng(lat, lon));
}

function AddMark(lat, lon) {
    var pos = new google.maps.LatLng(lat, lon);
    var opt = {
        map: map,
        position: pos,
        icon: icon,
        draggable: true
    };
    mark = new google.maps.Marker(opt);
    google.maps.event.addListener(mark, 'dragend', function (event) {
        mark.setPosition(event.latLng);
        map.setCenter(event.latLng);
        window.external.setTextBox(event.latLng.lat(), event.latLng.lng());
    });

    google.maps.event.addListener(map, 'rightclick', function (event) {
        mark.setPosition(event.latLng);
        map.setCenter(event.latLng);
        window.external.setTextBox(event.latLng.lat(), event.latLng.lng());
    });
}

function PosMark(lat, lon) {
    mark.setPosition(new google.maps.LatLng(lat, lon));
}

</script>
</head>

<body style="margin: 0;"; scroll="no" onload="init()">
    <div id="map" style="height: 100%; width: 100%;"> </div>
</body>
</html>
